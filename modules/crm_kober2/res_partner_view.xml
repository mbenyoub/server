<?xml version="1.0"?>
<openerp>
    <data>
    
<!--
        Personalizacion de action de partner
-->
        
        <record id="base.action_partner_form" model="ir.actions.act_window">
            <field name="name">Clientes</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">res.partner</field>
            <field name="view_type">form</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="context">{"default_is_company": True, "search_default_customer":1, "search_default_is_company":1, "search_default_status":"ALTA"}</field>
            <field name="domain">['|',('branch_id.user_ids','in',(uid)),('branch_id','=',False)]</field>
            <field name="search_view_id" ref="base.view_res_partner_filter"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to add a contact in your address book.
              </p><p>
                OpenERP helps you easily track all activities related to
                a customer; discussions, history of business opportunities,
                documents, etc.
              </p>
            </field>
        </record>
    
<!--
        Personalizacion de search de partner
-->
        <record model="ir.ui.view" id="view_res_partner_filter_inherit">
            <field name="name">res.partner.search.inherit</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_res_partner_filter" />
            <field name="priority" eval="18"/>
            <field name="arch" type="xml">
                <field name="name" position="after">
                    <field name="have_spin"/>
                    <field name="status"/>
                    <field name="category_id"/>
                    <field name="family"/>
                    <field name="category"/>
                    <field name="type_client"/>
                </field>
                <filter name="type_company" position="after">
                    <separator/>
                    <filter string="Tiene spin" name="have_spin" domain="[('have_spin','=',True)]"/>
                    <filter string="No tiene spin" name="not_have_spin" domain="[('have_spin','=',False)]"/>
                </filter>
                <filter help="My Partners" position="replace"/>
                <filter name="type_person" position="replace"/>
                <filter name="type_company" position="replace">
                    <filter name="type_client" string="Clientes"  domain="[('is_company','=',1)]"></filter>
                    <filter name="type_contact" string="Contactos"  domain="[('is_company','=',0),('is_address','=',0)]"></filter>
                    <filter name="type_address" string="Sucursal"  domain="[('is_address','=',1)]"></filter>
                </filter>
                <filter name="customer" position="replace"/>
                <filter name="supplier" position="replace">
                    <filter string="Clientes activos" name="status_alta" domain="[('status','=','ALTA')]"></filter>
                </filter>
                <filter string="Company" position="replace"/>
                <filter string="Country" position="after">
                    <filter string="Tipo" context="{'group_by': 'type_client'}"/>
                    <filter string="Estatus" context="{'group_by': 'status'}"/>
                    <filter string="Grupo" context="{'group_by': 'category_id'}"/>
                    <filter string="Categoria" context="{'group_by': 'category'}"/>
                    <filter string="Familia" context="{'group_by': 'family'}"/>
                </filter>
            </field>
        </record>
    
<!--
        Vista formulario partner
-->
        <record model="ir.ui.view" id="res_partner_view_inherit">
            <field name="name">res.partner.view.inherit</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_form" />
            <field name="priority" eval="22"/>
            <field name="arch" type="xml">
                <field name="category_id" position="attributes">
                    <attribute name="attrs" >{'invisible': [('is_company','=',False),('is_address','=',False)]}</attribute>
                    <attribute name="placeholder" >Grupo..</attribute>
                    <attribute name="widget" ></attribute>
                </field>
                <field name="property_account_receivable" position="attributes">
                    <attribute name="required" >0</attribute>
                    <attribute name="modifiers" >{}</attribute>
                </field>
                <field name="property_account_payable" position="attributes">
                    <attribute name="required" >0</attribute>
                    <attribute name="modifiers" >{}</attribute>
                </field>
                <field name="street" position="after">
                    <field name="street3" placeholder="Numero..." attrs="{'invisible': [('is_address','=',True)]}"></field>
                </field>
                <field name="street2" position="after">
                    <field name="delegation" placeholder="Delegacion..." ></field>
                    <field name="region" placeholder="Zona..." attrs="{'invisible': [('is_address','=',True)]}"/>
                </field>
                <field name="street2" position="attributes">
                    <attribute name="placeholder">Colonia...</attribute>
                </field>
                <field name="phone" position="after">
                    <field name="extension" attrs="{'invisible': ['|',('is_company','=',True),('is_address','=',True)]}"></field>
                </field>
                <field name="mobile" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="title" position="after">
                    <field name="attention" attrs="{'invisible': ['|',('is_company','=',True),('is_address','=',True)]}"></field>
                    <field name="sex" attrs="{'invisible': ['|',('is_company','=',True),('is_address','=',True)]}"></field>
                </field>
                <field name="email" position="after">
                    <field name="vat2" string="RFC" attrs="{'invisible': [('is_company','=',False)]}"/>
                </field>
                <div class="oe_edit_only" position="attributes">
                    <attribute name="name">div_type</attribute>
                    <attribute name="class"></attribute>
                </div>
                <label for="name" position="attributes">
                    <attribute name="class">oe_edit_only</attribute>
                </label>
                <page string="Sales &amp; Purchases" position="attributes">
                    <attribute name="string">Informacion Adicional</attribute>
                    <attribute name="name">information</attribute>
                </page>
                <field name="street" position="attributes">
                    <attribute name="placeholder">Calle...</attribute>
                </field>
                <field name="zip" position="attributes">
                    <attribute name="placeholder">CP</attribute>
                </field>
                <field name="fax" position="attributes">
                    <attribute name="attrs">{'invisible': [('is_company','=',False),('is_address','=',False)]}</attribute>
                </field>
                <field name="function" position="attributes">
                    <attribute name="attrs">{'invisible': ['|',('is_company','=',True),('is_address','=',True)]}</attribute>
                </field>
                <field name="title" position="attributes">
                    <attribute name="attrs">{'invisible': ['|',('is_company','=',True),('is_address','=',True)]}</attribute>
                </field>
                <field name="date_birth" position="attributes">
                    <attribute name="attrs">{'invisible': ['|',('is_company','=',True),('is_address','=',True)]}</attribute>
                </field>
                <field name="website" position="attributes">
                    <attribute name="attrs">{'invisible': [('is_company','=',False)]}</attribute>
                </field>
                <field name="date" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="customer" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="parent_id" position="attributes">
                    <attribute name="attrs">{'required': [('is_company','=',False)], 'invisible': [('is_company','=',True)]}</attribute>
                    <attribute name="on_change">onchange_parent(parent_id,is_company)</attribute>
                </field>
                <field name="notify" position="attributes">
                    <attribute name="attrs">{'invisible': [('is_company','=',False),('is_address','=',False)]}</attribute>
                </field>
                <group name="notify_buttons" position="attributes">
                    <attribute name="attrs">{'invisible': [('is_company','=',False),('is_address','=',False)]}</attribute>
                </group>
                <field name="activity" position="attributes">
                    <attribute name="attrs">{'invisible': [('is_company','=',False),('is_address','=',False)]}</attribute>
                </field>
                <field name="user_id" position="attributes">
                    <attribute name="attrs">{'invisible': [('is_company','=',False),('is_address','=',False)], 'required': [('notify','=',True),'|',('is_company','=',True),('is_address','=',True)]}</attribute>
                    <attribute name="on_change">onchange_user_id(user_id)</attribute>
                </field>
                <field name="section_id" position="attributes">
                    <attribute name="attrs">{'invisible': [('is_company','=',False),('is_address','=',False)], 'required': [('notify','=',True),'|',('is_company','=',True),('is_address','=',True)]}</attribute>
                </field>
                <xpath expr="/form/sheet/group/group" position="attributes">
                    <attribute name="attrs">{'invisible': [('is_company','=',False),('is_address','=',False)]}</attribute>
                </xpath>
                <xpath expr="/form/sheet/notebook/page/group/group/field[@name='supplier']" position="after">
                    <field name="date_create" readonly="1"  attrs="{'invisible': [('is_company','=',False)]}"></field>
                    <field name="block_morosos" readonly="1"  attrs="{'invisible': [('is_company','=',False)]}"></field>
                    <field name="have_mov" readonly="1"  attrs="{'invisible': [('is_company','=',False),('is_address','=',False)]}"></field>
                </xpath>
                <xpath expr="/form/sheet/notebook/page/group/group/field[@name='supplier']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="/form/sheet/notebook/page[@name='accounting']" position="attributes">
                    <attribute name="invisible" >1</attribute>
                    <attribute name="attrs" >{}</attribute>
                    <attribute name="modifiers" >{}</attribute>
                </xpath>
                <xpath expr="/form/sheet/notebook/page[@name='accounting_disabled']" position="attributes">
                    <attribute name="invisible" >1</attribute>
                    <attribute name="attrs" >{}</attribute>
                    <attribute name="modifiers" >{}</attribute>
                </xpath>
                <field name="active" position="before">
                    <field name="type_contact" attrs="{'invisible': ['|',('is_company','=',True),('is_address','=',True)]}"></field>
                    <field name="type_client" attrs="{'invisible': [('is_company','=',False)]}"></field>
                    <field name="status" readonly="1" attrs="{'invisible': [('is_company','=',False),('is_address','=',False)]}"></field>
                </field>
                <field name="active" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="lang" position="after">
                    <field name="currency_id" attrs="{'invisible': [('is_company','=',False)]}"></field>
                </field>
                <field name="is_company" position="replace">
                    <field name="have_ws_id" invisible="1"/>
                    <field name="is_address" class="oe_inline" attrs="{'invisible': [('is_company','=',True)], 'readonly': [('have_ws_id','=',True)]}"/>
                </field>
                <label for="is_company" position="replace">
                    <label for="is_address" string="¿Es una sucursal?" attrs="{'invisible': [('is_company','=',True)]}"/>)
                </label>
                <field name="is_address" position="before">
                    <field name="is_company" on_change="onchange_type(is_company)" class="oe_inline" modifiers="{}" attrs="{'invisible': [('is_address','=',True)], 'readonly': [('have_ws_id','=',True)]}"/>
                    <label for="is_company" string="¿Es una empresa?" attrs="{'invisible': [('is_address','=',True)]}"/>
                </field>
                <page name="information" position="inside">
                    <group>
                        <group>
                            <field name="competence" string="¿Es competencia?"/>
                            <field name="swot_id" attrs="{'invisible': [('competence','=',False)], 'required': [('competence','=',True)]}"/>
                        </group>
                        <group>
                            <field name="client" readonly="1" attrs="{'invisible': [('is_company','=',False)]}"></field>
                            <field name="ws_id" readonly="1" ></field>
                            <field name="category" attrs="{'invisible': [('is_company','=',False),('is_address','=',False)]}"></field>
                            <field name="family" attrs="{'invisible': [('is_company','=',False),('is_address','=',False)]}"></field>
                            <field name="bunch" attrs="{'invisible': [('is_company','=',False)]}"></field>
                            <field name="partial_order" attrs="{'invisible': [('is_company','=',False)]}"></field>
                        </group>
                        <group>
                            <field name="credit" attrs="{'invisible': [('is_company','=',False)]}"></field>
                            <field name="discount" attrs="{'invisible': [('is_company','=',False),('is_address','=',False)]}"></field>
                            <field name="condition" attrs="{'invisible': [('is_company','=',False),('is_address','=',False)]}" groups="base.group_sale_manager"></field>
                            <field name="price_list_esp" attrs="{'invisible': [('is_company','=',False),('is_address','=',False)]}" groups="base.group_sale_manager"/>
                        </group>
                    </group>
                </page>
                <page string="Contacts" position="after">
                    <page string="Sucursal" attrs="{'invisible': [('is_company','=',False),('address_ids', '=', [])]}" autofocus="autofocus">
                        <field name="address_ids" mode="kanban" context="{'default_parent_id': active_id, 'default_street': street, 'default_street2': street2, 'default_city': city, 'default_state_id': state_id, 'default_zip': zip, 'default_country_id': country_id, 'default_is_company': is_address, 'default_is_address': is_company}">
                            <kanban>
                                <field name="color"/>
                                <field name="name"/>
                                <field name="title"/>
                                <field name="email"/>
                                <field name="is_company"/>
                                <field name="parent_id"/>
                                <field name="function"/>
                                <field name="phone"/>
                                <field name="street"/>
                                <field name="street2"/>
                                <field name="zip"/>
                                <field name="city"/>
                                <field name="country_id"/>
                                <field name="mobile"/>
                                <field name="fax"/>
                                <field name="state_id"/>
                                <field name="has_image"/>
                                <templates>
                                    <t t-name="kanban-box">
                                        <t t-set="color" t-value="kanban_color(record.color.raw_value)"/>
                                        <div t-att-class="color + (record.title.raw_value == 1 ? ' oe_kanban_color_alert' : '')" style="position: relative">
                                            <a t-if="! read_only_mode" type="delete" style="position: absolute; right: 0; padding: 4px; diplay: inline-block">X</a>
                                            <div class="oe_module_vignette">
                                            <a type="open">
                                                <t t-if="record.has_image.raw_value === true">
                                                    <img t-att-src="kanban_image('res.partner', 'image', record.id.value, {'preview_image': 'image_small'})" class="oe_avatar oe_kanban_avatar_smallbox"/>
                                                </t>
                                                <t t-if="record.image and record.image.raw_value !== false">
                                                    <img t-att-src="'data:image/png;base64,'+record.image.raw_value" class="oe_avatar oe_kanban_avatar_smallbox"/>
                                                </t>
                                                <t t-if="record.has_image.raw_value === false and (!record.image or record.image.raw_value === false)">
                                                    <t t-if="record.is_company.raw_value === true">
                                                        <img t-att-src="_s + &quot;/base/static/src/img/company_image.png&quot;" class="oe_kanban_image oe_kanban_avatar_smallbox"/>
                                                    </t>
                                                    <t t-if="record.is_company.raw_value === false">
                                                        <img t-att-src="_s + &quot;/base/static/src/img/avatar.png&quot;" class="oe_kanban_image oe_kanban_avatar_smallbox"/>
                                                    </t>
                                                </t>
                                            </a>
                                                <div class="oe_module_desc">
                                                    <div class="oe_kanban_box_content oe_kanban_color_bglight oe_kanban_color_border">
                                                        <table class="oe_kanban_table">
                                                            <tr>
                                                                <td class="oe_kanban_title1" align="left" valign="middle">
                                                                    <h4><a type="open"><field name="name"/></a></h4>
                                                                    <i><div t-if="record.function.raw_value">
                                                                        <field name="function"/></div></i>
                                                                    <div t-if="record.phone.raw_value">Phone: <field name="phone"/></div>
                                                                    <div t-if="record.fax.raw_value">Fax: <field name="fax"/></div>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </t>
                                </templates>
                            </kanban>
                            <form string="Sucursal" version="7.0">
                                <sheet>
                                    <field name="image" widget="image" class="oe_avatar oe_left" options='{"preview_image": "image_medium"}'/>
                                    <div class="oe_title">
                                        <label for="name" class="oe_edit_only"/>
                                        <h1><field name="name" style="width: 90%%"/></h1>
                                        <field name="category_id" placeholder="Grupo..." style="width: 90%%"/>
                                    </div>
                                    <group>
                                        <field name="is_company" invisible="1"/>
                                        <field name="is_address" invisible="1"/>
                                        <field name="phone"/>
                                        <field name="fax"/>
                                    </group>
                                    <separator/>
                                    <group>
                                        <label for="street" string="Direccion"/>
                                        <div name="div_address">
                                            <field name="street" placeholder="Direccion..."/>
                                            <field name="street2" placeholder="Colonia..."/>
                                            <field name="delegation" placeholder="Delegacion..."/>
                                            <field name="region" placeholder="Zona..."/>
                                            <div class="address_format">
                                                <field name="city" placeholder="Poblacion" style="width: 40%%"/>
                                                <field name="state_id" class="oe_no_button" placeholder="Estado" style="width: 38%%" options='{"no_open": True}' on_change="onchange_state(state_id)"/>
                                                <field name="zip" placeholder="CP" style="width: 20%%"/>
                                            </div>
                                            <field name="country_id" placeholder="Pais" class="oe_no_button" options='{"no_open": True}'/>
                                        </div>
                                    </group>
                                    <separator/>
                                    <group>
                                        <group groups="base.group_sale_manager">
                                            <field name="notify"/>
                                            <field name="user_id"/>
                                            <field name="section_id"/>
                                        </group>
                                        <group>
                                            <field name="discount" readonly="1"/>
                                            <field name="condition"/>
                                            <field name="category"/>
                                            <field name="family"/>
                                        </group>
                                        <group>
                                            <field name="status"/>
                                            <field name="price_list_esp" groups="base.group_sale_manager"/>
                                            <field name="have_mov" readonly="1"/>
                                        </group>
                                    </group>
                                </sheet>
                            </form>
                        </field>
                    </page>
                </page>
                <page string="Contacts" position="replace">
                    <page string="Contactos" attrs="{'invisible': [('is_company','=',False), ('child_ids', '=', [])]}" autofocus="autofocus">
                        <field name="child_ids" mode="kanban" context="{'default_parent_id': active_id, 'default_street': street, 'default_street2': street2, 'default_city': city, 'default_state_id': state_id, 'default_zip': zip, 'default_country_id': country_id, 'default_is_company': is_address, 'default_is_address': is_address}">
                            <kanban>
                                <field name="color"/>
                                <field name="name"/>
                                <field name="title"/>
                                <field name="email"/>
                                <field name="is_company"/>
                                <field name="parent_id"/>
                                <field name="function"/>
                                <field name="phone"/>
                                <field name="street"/>
                                <field name="street2"/>
                                <field name="zip"/>
                                <field name="city"/>
                                <field name="country_id"/>
                                <field name="mobile"/>
                                <field name="fax"/>
                                <field name="state_id"/>
                                <field name="has_image"/>
                                <templates>
                                    <t t-name="kanban-box">
                                        <t t-set="color" t-value="kanban_color(record.color.raw_value)"/>
                                        <div t-att-class="color + (record.title.raw_value == 1 ? ' oe_kanban_color_alert' : '')" style="position: relative">
                                            <a t-if="! read_only_mode" type="delete" style="position: absolute; right: 0; padding: 4px; diplay: inline-block">X</a>
                                            <div class="oe_module_vignette">
                                            <a type="open">
                                                <t t-if="record.has_image.raw_value === true">
                                                    <img t-att-src="kanban_image('res.partner', 'image', record.id.value, {'preview_image': 'image_small'})" class="oe_avatar oe_kanban_avatar_smallbox"/>
                                                </t>
                                                <t t-if="record.image and record.image.raw_value !== false">
                                                    <img t-att-src="'data:image/png;base64,'+record.image.raw_value" class="oe_avatar oe_kanban_avatar_smallbox"/>
                                                </t>
                                                <t t-if="record.has_image.raw_value === false and (!record.image or record.image.raw_value === false)">
                                                    <t t-if="record.is_company.raw_value === true">
                                                        <img t-att-src="_s + &quot;/base/static/src/img/company_image.png&quot;" class="oe_kanban_image oe_kanban_avatar_smallbox"/>
                                                    </t>
                                                    <t t-if="record.is_company.raw_value === false">
                                                        <img t-att-src="_s + &quot;/base/static/src/img/avatar.png&quot;" class="oe_kanban_image oe_kanban_avatar_smallbox"/>
                                                    </t>
                                                </t>
                                            </a>
                                                <div class="oe_module_desc">
                                                    <div class="oe_kanban_box_content oe_kanban_color_bglight oe_kanban_color_border">
                                                        <table class="oe_kanban_table">
                                                            <tr>
                                                                <td class="oe_kanban_title1" align="left" valign="middle">
                                                                    <h4><a type="open"><field name="name"/></a></h4>
                                                                    <i><div t-if="record.function.raw_value">
                                                                        <field name="function"/></div></i>
                                                                    <div><a t-if="record.email.raw_value" title="Mail" t-att-href="'mailto:'+record.email.value">
                                                                        <field name="email"/>
                                                                    </a></div>
                                                                    <div t-if="record.phone.raw_value">Phone: <field name="phone"/></div>
                                                                    <div t-if="record.mobile.raw_value">Mobile: <field name="mobile"/></div>
                                                                    <div t-if="record.fax.raw_value">Fax: <field name="fax"/></div>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </t>
                                </templates>
                            </kanban>
                            <form string="Contacto" version="7.0">
                                <sheet>
                                    <field name="image" widget="image" class="oe_avatar oe_left" options='{"preview_image": "image_medium"}'/>
                                    <div class="oe_title">
                                        <label for="name" class="oe_edit_only"/>
                                        <h1><field name="name" style="width: 90%%"/></h1>
                                    </div>
                                    <group>
                                        <field name="function"/>
                                        <field name="phone"/>
                                        <field name="extension"/>
                                        <field name="email"/>
                                        <field name="attention"/>
                                        <field name="title"/>
                                        <field name="type_contact"/>
                                        <field name="sex"/>
                                        <field name="date_birth"/>
                                    </group>
                                    <separator/>
                                </sheet>
                            </form>
                        </field>
                    </page>
                </page>
                <notebook position="inside">
                    <page string="SPIN" attrs="{'invisible': [('is_company','=',False)]}">
                        <div>
                            <label for="spin_required" string="¿Spin es obligatorio?"/>
                            <field name="spin_required" class="oe_inline"/>
                        </div>
                        <separator/>
                        <label for="spin" string="¿CUALES SON LOS BENEFICIOS DE KOBER, QUE MAS LE INTERESARON A ESTE CLIENTE?"/>
                        <br/>
                        <label for="spin" string="Y ¿QUE PREGUNTA TE LLEVO A DETECTARLOS?"/>
                        <div>
                            <field name="spin" attrs="{'required': [('is_company','=',True),('spin_required','=',True)]}"></field>
                        </div>
                        <field name="have_spin" invisible="1"/>
                    </page>
                </notebook>
            </field>
        </record>
        
        <record model="ir.ui.view" id="view_partner_tree_view">
            <field name="name">res.partner.view.inherit</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_tree" />
            <field name="priority" eval="18"/>
            <field name="arch" type="xml">
                <field name="email" position="after">
                    <field name="have_spin" invisible="1"/>
                    <field name="type_client" invisible="1"/>
                    <field name="status" invisible="1"/>
                    <field name="category" invisible="1"/>
                    <field name="family" invisible="1"/>
                    <field name="category_id" invisible="1"/>
                </field>
            </field>
        </record>
        
        <!--
            Acuerdos de cobranza
        -->
        
        <!--View Tree - Agreement -->
        <record model="ir.ui.view" id="res_partner_agreement_tree_view">
            <field name="name">Acuerdos de cobranza</field>
            <field name="model">res.partner.agreement</field>
            <field name="arch" type="xml">
                <tree string="Acuerdos de cobranza" colors="grey:state=='complied';blue:state=='not_complied'">
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="user_id" />
                    <field name="date_agree"/>
                    <field name="state" />
                    <field name="branch_id" invisible="1"/>
                </tree>
            </field>
        </record>
        
        <!-- View form - Agreement -->
        <record model="ir.ui.view" id="res_partner_agreement_form_view">
            <field name="name">Acuerdos de cobranza</field>
            <field name="model">res.partner.agreement</field>
            <field name="arch" type="xml">
                <form string="Acuerdos de Cobranza" version="7.0">
                    <header>
                        <button name="action_agree" type="object" states="to_comply,not_complied" string="Cumplido" class="oe_highlight"/>
                        <button name="action_agree" type="object" states="to_comply" string="No cumplido"/>
                        <field name="state" widget="statusbar" class="oe_inline"/>
                    </header>
                    <sheet string="Acuerdos de cobranza">
                        <group colspan="4" col="4">
                            <group colspan="2" col="2">
                                <field name="name"/>
                                <field name="partner_id"/>
                                <field name="user_id"/>
                            </group>
                            <group colspan="2" col="2">
                                <field name="date_agree"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Notas">
                                <field name="notes"/>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>
        
        <!-- Agreement Search View  -->
        <record id="view_res_partner_agreement_search" model="ir.ui.view">
            <field name="name">res.partner.agreement.search</field>
            <field name="model">res.partner.agreement</field>
            <field name="arch" type="xml">
                <search string="Search Activity">
                    <field name="name" filter_domain="['|',('name','ilike',self),('partner_id','ilike',self)]"/>
                    <field name="partner_id"/>
                    <field name="date_agree"/>
                    <field name="user_id"/>
                    <field name="state"/>
                    <field name="branch_id"/>
                    <separator/>
                    <filter string="Mis Acuerdos" help="Ver acuerdos donde soy responsable" domain="[('user_id','=',uid)]"/>
                    <filter icon="terp-gtk-go-back-rtl" string="Mi sucursal" name="filter_branch_id" domain="[('branch_id.branch_user_ids','in',(uid))]"/>
                    <separator/>
                    <group expand="0" string="Agrupar por...">
                        <filter string="Cliente" name="group_partner"  icon="terp-folder-violet" domain="[]" context="{'group_by':'partner_id'}"/>
                        <filter string="Responsable" name="group_user"  icon="terp-folder-violet" domain="[]" context="{'group_by':'user_id'}"/>
                        <filter string="Estatus" name="group_state"  icon="terp-folder-violet" domain="[]" context="{'group_by':'state'}"/>
                        <filter string="Fecha" name="group_date"  icon="terp-folder-violet" domain="[]" context="{'group_by':'date_agree'}"/>
                    </group>
                </search>
            </field>
        </record>
        
        <!-- action windows - Agreement -->
        <record model="ir.actions.act_window" id="act_partner_agreement_view">
            <field name="name">Acuerdos de cobranza</field>
            <field name="res_model">res.partner.agreement</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">['|',('branch_id.user_ids','in',(uid)),('branch_id','=',False)]</field>
            <field name="context">{}</field>
            <field name="view_id" ref="res_partner_agreement_tree_view"/>
            <field name="search_view_id" ref="view_res_partner_agreement_search"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">Genera un acuerdo de credito y cobranza sobre el cliente</p>
            </field>
        </record>

        <!-- Menu item -->
        <menuitem action="act_partner_agreement_view" id="base.menu_partner_agreement" name="Acuerdos de cobranza" parent="base.menu_sales" sequence="30" />
        
<!--
    Modificacion de la vista kanban de proyecto
-->
        
        <!-- open opportunities related to given partner -->
        <record model="ir.actions.act_window" id="relate_partner_agreement">
            <field name="name">Acuerdos de Cobranza</field>
            <field name="res_model">res.partner.agreement</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[]</field>
            <field name="context">{'search_default_partner_id': active_id,'search_default_state': 'to_comply'}</field>
            <field name="view_id" eval="res_partner_agreement_tree_view"/>
            <field name="search_view_id" ref="view_res_partner_agreement_search"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">Genera un acuerdo de credito y cobranza sobre el cliente</p>
            </field>
        </record>
        
        <!-- Partner kanban view inherte -->
        <record model="ir.ui.view" id="res_partner_kanban_view_inherit">
            <field name="name">res.partner.kanban.inherit</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.res_partner_kanban_view"/>
            <field name="priority" eval="16"/>
            <field name="arch" type="xml">
                <field name="mobile" position="after">
                    <field name="agree_count"/>
                </field>
                <xpath expr="//div[@class='oe_kanban_partner_links']" position="inside">
                    <a name="%(relate_partner_agreement)d" type="action" t-if="record.agree_count.value>0">
                        <t t-esc="record.agree_count.value"/> Acuerdos
                    </a>
                </xpath>
            </field>
        </record>
        
    </data>
</openerp>

